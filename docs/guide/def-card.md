
# 卡片
## 内置卡片
## 卡片的配置
## 卡片内容自动复制

::: tip 单据数据结构
每一个自定义卡片在单据中，都有其自己的key值，这些key值，在一个单据中是唯一的，通过这些key值组装出一个单据的基本数据结构
:::

相同业务属性的卡片，我们可以将卡片的key值设置成一样，相对应的字段key值也设置成一样，那么单据在创建的时候，数据会自动从前后复制过来

做到这个效果的前提是：
- 卡片实现了数据复制的方法
- `单据配置`-`功能卡片` 配置中，卡片对应的`数据复制`列设置为 `true`  

可能会出现的错误：
- 前后续卡片key相同，但是数据结构完全不一致，如前序为List（Grid），后续为Single（Form）
- 前后续卡片key相同，数据结构也一致，但是数据类型不一致，且数据类型不兼容，如前序为String，后续为Number


## 单据头
## 动态表单
## 动态表格
## 动态字段





## 还款计划卡片

#### 配置参数
- 计算公式 表示还款计划计算的方法，如等额本金、等额本息（年金）等
- 计算选项 表示计算公式函数需要的计算参数，它是一个json格式，格式内容由计算函数决定

#### 等额本息（年金）
- 公式名称 NkFinanceMethod01
- pv : 期初金额
- ir : 年利率
- np : 还款次数
- pf : 还款频率 即每一年还款的次数，如年付=1，季度付=4，月付=12
- fv : 期末金额 即尾款
- dt : 起始日期
- tp : 期末支付 = 0 或 期初支付 1 默认为0

#### 等额本金
- 公式名称 NkFinanceMethod02
- pv : 期初金额
- ir : 年利率
- np : 还款次数
- pf : 还款频率 即每一年还款的次数，如年付=1，季度付=4，月付=12
- fv : 期末金额 即尾款
- dt : 起始日期
- tp : 期末支付 = 0 或 期初支付 1 默认为0

#### 自定义公式

开发一个服务组件，继承 `NkAbstractApplyCSO` 实现相应方法即可






## 账单卡片

#### 配置参数
|参数|类型|描述|示例|
|----|----|----|----|
|激活条件|SpEL Boolean|表示账单生效的条件，建议通过单据的状态判断|`docState == 'S003'`|
|还款计划卡片|String|还款计划卡片的KEY，账单将从还款计划中拉去数据作为账单应收项目|-|
|账单源|SpEL Array|自定义的账单项目来源||

#### 账单源

- 账单源是一个Array格式的SpEL模版，每项item的值表示一个数据来源
- item可以为一个Object格式的对象，表示一条账单应收
- item也可以为一个Array格式的对象，表示多条账单应收

#### 账单源示例

```spel
{  
  {
    "billType": "首付款",
    "expireDate": "${data.scheme?.startDate}",
    "amount": "${data.scheme?.downPaymentAmount}"
  },
  [
    {
        "billType": "保证金",
        "expireDate": "${data.scheme?.date1}",
        "amount": "${data.scheme?.amount1}"
    },
    {
        "billType": "保证金2",
        "expireDate": "${data.scheme?.date2}",
        "amount": "${data.scheme?.amount2}"
    }
  ]
}
```

## 格式化
## 引用
## 字段选项
## 开发卡片
## 卡片的构成要件
## 配置视图
## 数据视图
## 卡片事件
## 创建事件
## 运算事件
## 更新事件
## 加载事件
## 调用事件
## 数据结构
## 自定义表结构